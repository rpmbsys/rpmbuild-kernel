version: "3"
services:
  centos7build:
    volumes:
      - rpm7:/home/centos/rpmbuild/RPMS
    build:
      context: .
      args:
        centos: $OS7
    command: ["-ba",
      "--without", "doc",
      "--without", "selftests",
      "--without", "debuginfo",
      "--without", "kabidwchk",
      "--without", "kabidw-base"]
  centos7kernelonly:
    volumes:
      - rpm7:/home/centos/rpmbuild/RPMS
    build:
      context: .
      args:
        centos: $OS7
    command: ["-ba",
      "--without", "doc",
      "--without", "selftests",
      "--without", "debuginfo",
      "--without", "kabidwchk",
      "--without", "kabidw-base",
      "--with",    "baseonly",
      "--without", "perf",
      "--without", "tools",
      "--without", "bpftool",
      "--without", "gcov",
      "--without", "ipaclones",
      "--without", "kernel-abi-whitelists"]
  centos7kernelvanilla:
    volumes:
      - rpm7:/home/centos/rpmbuild/RPMS
    build:
      context: .
      args:
        centos: $OS7
    command: ["-ba",
      "--without", "doc",
      "--without", "selftests",
      "--without", "debuginfo",
      "--without", "kabidwchk",
      "--without", "kabidw-base",
      "--with",    "baseonly",
      "--without", "perf",
      "--without", "tools",
      "--without", "bpftool",
      "--without", "gcov",
      "--without", "ipaclones",
      "--without", "kernel-abi-whitelists",
      "--with",    "vanilla"]
  stream8build:
    volumes:
      - rpm8stream:/home/centos/rpmbuild/RPMS
    build:
      context: .
      args:
        centos: stream8
    command: ["-ba",
      "--without", "doc",
      "--without", "selftests",
      "--without", "debuginfo",
      "--without", "kabidwchk",
      "--without", "kabidw-base"]
  stream8kernelonly:
    volumes:
      - rpm8stream:/home/centos/rpmbuild/RPMS
    build:
      context: .
      args:
        centos: stream8
    command: ["-ba",
      "--without", "doc",
      "--without", "selftests",
      "--without", "debuginfo",
      "--without", "kabidwchk",
      "--without", "kabidw-base",
      "--with",    "baseonly",
      "--without", "perf",
      "--without", "tools",
      "--without", "bpftool",
      "--without", "gcov",
      "--without", "ipaclones",
      "--without", "kernel-abi-whitelists"]

volumes:
  rpm7:
    name: rpm7
  rpm8stream:
    name: rpm8stream